flowchart TD
    A[Start] --> B[Load Excel Dataset]
    B --> C[Process Each Sheet]
    C --> C1[Extract Weightage & Total]
    C --> C2[Clean Data Rows]
    C --> C3[Compute Weighted Scores<br>for Assignments/Quizzes]
    C --> C4[Preserve S-I, S-II, Final Scores]
    C1 & C2 & C3 & C4 --> D[Merge All Sheets]
    D --> E[Compute Aggregates]
    E --> E1[A_Sum<br>(best 4 assignments)]
    E --> E2[Q_Sum<br>(best 6 quizzes)]
    E --> E3[AQ_Sum = A_Sum + Q_Sum]
    E1 & E2 & E3 --> F[Save Cleaned Dataset<br>→ "clean_weighted_dataset.csv"]
    F --> G[Exploratory Data Analysis (EDA)]
    G --> G1[Check Shape & Missing Values]
    G --> G2[Distribution Plots<br>(Assignments, Quizzes, Targets)]
    G --> G3[Correlation Matrix & Heatmap]
    G --> G4[Pairplots<br>(A_Sum, Q_Sum vs S-I, S-II, Final)]
    G --> G5[Boxplots (Outliers)]
    G --> G6[Scatter Plots<br>(A_Sum, Q_Sum vs Targets)]
    G1 & G2 & G3 & G4 & G5 & G6 --> H[RQ1: Predict S-I]
    H --> H1[Train/Test Split<br>X: A_Sum + Q_Sum, y: S-I]
    H --> H2[Train Models]
    H2 --> H2a[Multiple Linear Regression]
    H2 --> H2b[Polynomial Regression (deg 2)]
    H2 --> H2c[Dummy Regressor (mean)]
    H --> H3[Evaluate Models<br>(MAE, RMSE, R²)]
    H --> H4[Bootstrap MAE<br>(train, 500 samples)]
    H --> H5[Select Best Model]
    H --> H6[Save Outputs + Plot<br>Predicted vs Actual]
    H1 & H2a & H2b & H2c & H3 & H4 & H5 & H6 --> I[RQ2: Predict S-II]
    I --> I1[Train/Test Split]
    I1 --> I1a[MLR: X = S-I + Q_Sum]
    I1 --> I1b[Poly: X = S-I + Q_Sum + AQ_Sum]
    I --> I2[Train Models<br>(MLR, Polynomial, Dummy)]
    I --> I3[Evaluate Models<br>(MAE, RMSE, R²)]
    I --> I4[Bootstrap MAE<br>(train, 500 samples)]
    I --> I5[Train vs Test Metrics]
    I --> I6[Save Outputs + Plot<br>Predicted vs Actual]
    I1a & I1b & I2 & I3 & I4 & I5 & I6 --> J[RQ3: Predict Final]
    J --> J1[Train/Test Split]
    J1 --> J1a[MLR: X = S-I + S-II]
    J1 --> J1b[Poly: X = S-I + S-II + Q_Sum]
    J --> J2[Train Models<br>(MLR, Polynomial, Dummy)]
    J --> J3[Evaluate Models<br>(MAE, RMSE, R²)]
    J --> J4[Bootstrap MAE<br>(train, 500 samples)]
    J --> J5[Train vs Test Metrics]
    J --> J6[Save Outputs + Plot<br>Predicted vs Actual]
    J1a & J1b & J2 & J3 & J4 & J5 & J6 --> K[End]

    style A fill:#2ecc71,stroke:#27ae60,color:white
    style K fill:#e74c3c,stroke:#c0392b,color:white
    style F fill:#3498db,stroke:#2980b9,color:white
